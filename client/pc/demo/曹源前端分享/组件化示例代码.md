组件化

考虑到文件上传使用场景较多，为了适配这些应用场景。所以封装上传功能时候采用了脱离 UI 的封装方式。

1.  input 标签 onChange 事件监听 file

2.  动态渲染一个 input 标签

```jsx
// 动态渲染input标签，在body下面插入一个div，把input标签渲染到div下面，触发input标签。完成上传流程后将div和input一起删除
const creatUpload = props => {
    const div = document.createElement('div'); // 创建一个div

    document.body.appendChild(div); // 插入body
    const onFinished = () => {
        // 删除div
        ReactDOM.unmountComponentAtNode(div);
        document.body.removeChild(div);
    };
    const handleFileChange = e => {
        // input标签onChange事件
        const files = e.target.files;
        const config = props;

        if (files) {
            const options = {
                // 配置项
                type: config.type, // 上传类型 0 视频 1 图片 2 音频
                appid: config.appid, // 应用标识
                onBeforeUpload: config.onBeforeUpload,
                progressCallback: config.progressCallback,
                successCallback: config.successCallback,
                errorCallback: config.errorCallback,
                removeUpload: onFinished,
            };

            uploader(files, options); // 上传
        } else {
            return;
        }
    };

    ReactDOM.render(
        <div style={{ width: 0, height: 0, overflow: 'hidden' }}>
            <input
                type="file"
                id="upload_input"
                onChange={handleFileChange}
                title="选择文件"
                style={{ display: 'none' }}
            />
        </div>,
        div,
    );

    document.getElementById('upload_input').click();
};

const Upload = {};
// Upload只用来我们动态调用
Upload.start = props =>
    creatUpload({
        ...props,
    });
```

3.  可以使用的回调
    onBeforeUpload: 上传之前的回调，可以拿到 file
    uploadProgressCallback: 上传进度的回调，默认参数为上传进度、file
    successCallback: 上传成功的回调
    errorCallback: 上传失败的回调

兼容性
File API HTML5 新支持的 api，在低版本的浏览器中存在兼容性问题（最低支持到 IE10）

兼容策略：flash 实现
WebUploader
